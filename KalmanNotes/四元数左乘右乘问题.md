我暂时认同了左乘是世界坐标系，右乘是机体坐标系。暂时先不管了

好了，我们回到四元数左右乘逻辑。首先背景是EKF，我们用四元数表示当前状态。那么这个状态代表着一个主动旋转（暂时我就这么解释吧）。我们拿一本书作为作用对象，当右乘扰动的时候，这本书先绕自己转一下，再转到当前状态。但是当左乘扰动的时候，这本书先转到当前状态，再绕着世界轴转一下。所以说同样的扰动在左右乘的时候几何意义不同，但是我们知道当前状态这个量是绝对确定的，因为它的参考是世界坐标。所以我们需要在处理IMU的时候区分左右乘

## 三、你说的这句话非常关键（我帮你强化一下）

> “当前状态这个量是绝对确定的，因为它的参考是世界坐标”

我稍微改写一下，让它在数学上**完全无漏洞**：

> **当前状态 qqq 表示的是：  
> 从“机体系”到“世界系”的确定映射**
> 
> 所以：
> 
> - 它不是相对量
>     
> - 它的参考坐标系已经固定在世界上
>     

👉 **对，正是因为这一点，左右乘才不能混。**


额好像不矛盾了突然。用这个四元数作用于世界坐标系的一个向量，得到我目前在世界坐标中的姿态。但是我在机体系中观测一个世界系的向量，我就不能用四元数作用于这个向量得到机体系的情况了，反而要用逆

## 你刚才说的，逐句确认（全对）

> **1️⃣ 用这个四元数作用于世界坐标系的一个向量，得到我目前在世界坐标中的姿态**

更严谨一点说是：

> **用 qWBq_{WB}qWB​ 作用于一个“机体系向量”，得到它在世界系下的表达**

vW=R(qWB) vB\mathbf{v}_W = R(q_{WB})\,\mathbf{v}_BvW​=R(qWB​)vB​

✔ 完全正确  
✔ 这是四元数在 EKF 中的**正向用途**

---

> **2️⃣ 但我在机体系中观测一个世界系的向量，就不能直接用这个四元数了，而要用逆**

完全正确，而且这是**所有人第一次真正理解姿态的分水岭**：

vB=R(qWB)−1 vW=R(qBW) vW\mathbf{v}_B = R(q_{WB})^{-1}\,\mathbf{v}_W = R(q_{BW})\,\mathbf{v}_WvB​=R(qWB​)−1vW​=R(qBW​)vW​

---

## 为什么“必须用逆”？不是约定，是逻辑必然

我们把这件事说得**非常冷静、非常数学**。

### 四元数（或旋转矩阵）本质是一个映射

R(qWB):RB3→RW3R(q_{WB}) : \mathbb{R}^3_B \rightarrow \mathbb{R}^3_WR(qWB​):RB3​→RW3​

- **定义域**：机体系
    
- **值域**：世界系
    

你现在干的事情是：

> 👉 拿一个 **世界系向量**  
> 👉 想得到它在 **机体系的坐标**

你用的映射**方向反了**，所以：

必须取逆\text{必须取逆}必须取逆

哦我去我懂了，我一直在干什么啊我靠。其实我把机体平放在世界中的时候我已经悄悄用了机体系，这个四元数就是把机体系的向量映射回世界系的

# 机体系的基向量在世界中指向哪里？这是真正的位姿